<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Data transformation | Comparison between China and the U.S. in Prepared Food Delivery</title>
  <meta name="description" content="Chapter 3 Data transformation | Comparison between China and the U.S. in Prepared Food Delivery" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Data transformation | Comparison between China and the U.S. in Prepared Food Delivery" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Data transformation | Comparison between China and the U.S. in Prepared Food Delivery" />
  
  
  

<meta name="author" content="Qingyang He, Yuwei Hu" />


<meta name="date" content="2022-04-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-sources.html"/>
<link rel="next" href="missing-values.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Prepared Food Delivery</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction<span></span></a></li>
<li class="chapter" data-level="2" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>2</b> Data sources<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-sources.html"><a href="data-sources.html#describe-the-data-sources"><i class="fa fa-check"></i><b>2.1</b> Describe the data sources<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="data-sources.html"><a href="data-sources.html#basic-information-about-the-food-delivery-datasets"><i class="fa fa-check"></i><b>2.2</b> Basic information about the food delivery datasets<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="data-sources.html"><a href="data-sources.html#basic-information-about-the-supply-for-food-delivery-datasets"><i class="fa fa-check"></i><b>2.3</b> Basic information about the supply for food delivery datasets<span></span></a></li>
<li class="chapter" data-level="2.4" data-path="data-sources.html"><a href="data-sources.html#basic-information-about-the-demand-for-food-delivery-datasets"><i class="fa fa-check"></i><b>2.4</b> Basic information about the demand for food delivery datasets<span></span></a></li>
<li class="chapter" data-level="2.5" data-path="data-sources.html"><a href="data-sources.html#describe-any-issues-with-the-data"><i class="fa fa-check"></i><b>2.5</b> Describe any issues with the data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>3</b> Data transformation<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-transformation.html"><a href="data-transformation.html#food-delivery-data"><i class="fa fa-check"></i><b>3.1</b> Food delivery data<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="data-transformation.html"><a href="data-transformation.html#supply-data"><i class="fa fa-check"></i><b>3.2</b> Supply data<span></span></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-transformation.html"><a href="data-transformation.html#education"><i class="fa fa-check"></i><b>3.2.1</b> Education<span></span></a></li>
<li class="chapter" data-level="3.2.2" data-path="data-transformation.html"><a href="data-transformation.html#unemployment"><i class="fa fa-check"></i><b>3.2.2</b> Unemployment<span></span></a></li>
<li class="chapter" data-level="3.2.3" data-path="data-transformation.html"><a href="data-transformation.html#restaurant-number"><i class="fa fa-check"></i><b>3.2.3</b> Restaurant number<span></span></a></li>
<li class="chapter" data-level="3.2.4" data-path="data-transformation.html"><a href="data-transformation.html#working-earning"><i class="fa fa-check"></i><b>3.2.4</b> Working earning<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-transformation.html"><a href="data-transformation.html#demand-data"><i class="fa fa-check"></i><b>3.3</b> Demand data<span></span></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-transformation.html"><a href="data-transformation.html#smartphone-ownership"><i class="fa fa-check"></i><b>3.3.1</b> Smartphone ownership<span></span></a></li>
<li class="chapter" data-level="3.3.2" data-path="data-transformation.html"><a href="data-transformation.html#food-expenditures"><i class="fa fa-check"></i><b>3.3.2</b> Food expenditures<span></span></a></li>
<li class="chapter" data-level="3.3.3" data-path="data-transformation.html"><a href="data-transformation.html#working-hour"><i class="fa fa-check"></i><b>3.3.3</b> Working hour<span></span></a></li>
<li class="chapter" data-level="3.3.4" data-path="data-transformation.html"><a href="data-transformation.html#cpi"><i class="fa fa-check"></i><b>3.3.4</b> CPI<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>4</b> Missing values<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="missing-values.html"><a href="missing-values.html#data-source-1"><i class="fa fa-check"></i><b>4.1</b> Data Source 1<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="missing-values.html"><a href="missing-values.html#data-source-2"><i class="fa fa-check"></i><b>4.2</b> Data Source 2<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>5</b> Results<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="results.html"><a href="results.html#food-delivery-outlook"><i class="fa fa-check"></i><b>5.1</b> Food delivery outlook<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="results.html"><a href="results.html#demand-for-food-delivery-analysis"><i class="fa fa-check"></i><b>5.2</b> demand for food delivery analysis<span></span></a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="results.html"><a href="results.html#smartphone-ownership-analysis"><i class="fa fa-check"></i><b>5.2.1</b> smartphone ownership analysis<span></span></a></li>
<li class="chapter" data-level="5.2.2" data-path="results.html"><a href="results.html#working-hour-analysis"><i class="fa fa-check"></i><b>5.2.2</b> working hour analysis<span></span></a></li>
<li class="chapter" data-level="5.2.3" data-path="results.html"><a href="results.html#cpi-analysis"><i class="fa fa-check"></i><b>5.2.3</b> cpi analysis<span></span></a></li>
<li class="chapter" data-level="5.2.4" data-path="results.html"><a href="results.html#food-expenditure-analysis"><i class="fa fa-check"></i><b>5.2.4</b> food expenditure analysis<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="results.html"><a href="results.html#supply-for-food-delivery-analysis"><i class="fa fa-check"></i><b>5.3</b> supply for food delivery analysis<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interactive-component.html"><a href="interactive-component.html"><i class="fa fa-check"></i><b>6</b> Interactive component<span></span></a></li>
<li class="chapter" data-level="7" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>7</b> Conclusion<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="conclusion.html"><a href="conclusion.html#main-takeaways"><i class="fa fa-check"></i><b>7.1</b> Main takeaways<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="conclusion.html"><a href="conclusion.html#limitation"><i class="fa fa-check"></i><b>7.2</b> Limitation<span></span></a></li>
<li class="chapter" data-level="7.3" data-path="conclusion.html"><a href="conclusion.html#future-directions"><i class="fa fa-check"></i><b>7.3</b> Future directions<span></span></a></li>
<li class="chapter" data-level="7.4" data-path="conclusion.html"><a href="conclusion.html#lessons-learned"><i class="fa fa-check"></i><b>7.4</b> Lessons learned<span></span></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Comparison between China and the U.S. in Prepared Food Delivery</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-transformation" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Data transformation<a href="data-transformation.html#data-transformation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="food-delivery-data" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Food delivery data<a href="data-transformation.html#food-delivery-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Note: Given that we have multiple types of data obtained through different sources, the workload of the data cleaning phase is significant.</p>
<p>For food delivery data, we removed unrelated columns and selected rows based on multiple factor levels - “Online Food Delivery” for Market, and “Revenue” and “Users by Segment” for Chart. We create a new vector called “YEAR”, from the information stored in the specifying columns from 3 to 7. Then, we complete the tidying by pivoting “Chart” and “value” to make “Revenue” and “Users by Segment” columns.</p>
<pre><code>## # A tibble: 6 x 3
##   region        all_food_delivery online_food_delivery
##   &lt;chr&gt;                     &lt;dbl&gt;                &lt;dbl&gt;
## 1 United States              0.95                 1.23
## 2 Russia                     0.89                 1.17
## 3 Canada                     0.69                 1.13
## 4 Australia                  0.61                 0.61
## 5 Brazil                     0.51                 0.68
## 6 Japan                      0.43                 0.68</code></pre>
<pre><code>## # A tibble: 6 x 2
##   Year  food_delivery_share_in_food_service
##   &lt;chr&gt;                               &lt;dbl&gt;
## 1 2013                                0.061
## 2 2014                                0.064
## 3 2015                                0.067
## 4 2016                                0.069
## 5 2017                                0.072
## 6 2018                                0.076</code></pre>
<pre><code>## # A tibble: 6 x 4
##   Name                          YEAR  Revenue `Users by Segment`
##   &lt;chr&gt;                         &lt;chr&gt;   &lt;dbl&gt;              &lt;dbl&gt;
## 1 Total                         2017    23.4                81.2
## 2 Total                         2018    26.5                89.6
## 3 Total                         2019    31.0               101. 
## 4 Total                         2020    44.1               132. 
## 5 Total                         2021    56.9               150. 
## 6 Platform-to-Consumer Delivery 2017     9.26               40.1</code></pre>
</div>
<div id="supply-data" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Supply data<a href="data-transformation.html#supply-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="education" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Education<a href="data-transformation.html#education" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Due to the changes in the information collection process, some data were treated as missing data. For the breakdown of education levels in the dataset, it will be a large and unnecessary workload in future comparative analysis, so we divided the education level into 9 major categories. After this, we created the “YEAR” variable as we did in the previous sections and assign the summation of value to it.</p>
<pre><code>## # A tibble: 6 x 3
##   Year  degree                                value
##   &lt;chr&gt; &lt;chr&gt;                                 &lt;dbl&gt;
## 1 2010  Associate&#39;s degree, academic           9725
## 2 2010  Associate&#39;s degree, vocational         8533
## 3 2010  Bachelor&#39;s degree1                    30162
## 4 2010  College, no degree                    33662
## 5 2010  Elementary or High school, GED        62457
## 6 2010  Elementary or High school, no diploma 25712</code></pre>
</div>
<div id="unemployment" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Unemployment<a href="data-transformation.html#unemployment" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this section, the data we collected is on monthly basis. To maintain consistency of the previous data, we calculated the average unemployment rate by year.</p>
</div>
<div id="restaurant-number" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Restaurant number<a href="data-transformation.html#restaurant-number" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Removing irrelevant columns.</p>
</div>
<div id="working-earning" class="section level3 hasAnchor" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Working earning<a href="data-transformation.html#working-earning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Combine unemployment, restaurant number and working earning</li>
</ul>
<pre><code>## # A tibble: 6 x 4
##    Year working_earning restaurant_number avg_unemployment
##   &lt;dbl&gt;           &lt;dbl&gt;             &lt;dbl&gt;            &lt;dbl&gt;
## 1  2010            11.5            555688             9.62
## 2  2011            11.7            565632             8.95
## 3  2012            11.9            577281             8.07
## 4  2013            12.1            584843             7.38
## 5  2014            12.5            593346             6.17
## 6  2015            12.9            602294             5.29</code></pre>
</div>
</div>
<div id="demand-data" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Demand data<a href="data-transformation.html#demand-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="smartphone-ownership" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Smartphone ownership<a href="data-transformation.html#smartphone-ownership" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Removed irrelevant rows</p>
<p>Changed column names and date time format into desired data type</p>
<pre><code>## # A tibble: 6 x 2
##   Date       proportion
##   &lt;date&gt;          &lt;dbl&gt;
## 1 2011-04-01       0.35
## 2 2012-01-01       0.45
## 3 2012-03-01       0.46
## 4 2012-08-01       0.45
## 5 2012-10-01       0.47
## 6 2012-11-01       0.45</code></pre>
</div>
<div id="food-expenditures" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Food expenditures<a href="data-transformation.html#food-expenditures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Removed irrelevant columns</p>
<pre><code>## # A tibble: 6 x 3
##    Year `Food at home` `Food away from home`
##   &lt;dbl&gt;          &lt;dbl&gt;                 &lt;dbl&gt;
## 1  1997        353664.               265069.
## 2  1998        364084.               278004.
## 3  1999        386318.               292034.
## 4  2000        404815.               313060.
## 5  2001        423349.               326063.
## 6  2002        428442.               333839.</code></pre>
</div>
<div id="working-hour" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Working hour<a href="data-transformation.html#working-hour" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Changed the date time format into desired date type</p>
<p>Removed irrelevant Columns</p>
</div>
<div id="cpi" class="section level3 hasAnchor" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> CPI<a href="data-transformation.html#cpi" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>After removing the irrelevant columns, we converted the multiple monthly data of “CPI for all” and “CPI for food” to the new column. Then, we adjusted the format of the time to “Year” and “Month”. Since the two datasets now have a consistent scale and format, we merge the two data frames together by time.</p>
<ul>
<li>Combine CPI and working hours</li>
</ul>
<pre><code>## # A tibble: 6 x 6
##    Year Month food_cpi date       all_cpi week_working_hour
##   &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;date&gt;       &lt;dbl&gt;             &lt;dbl&gt;
## 1  2012 Jan        0.6 2012-01-01     0.4              34.5
## 2  2012 Feb        0   2012-02-01     0.4              34.5
## 3  2012 Mar        0.1 2012-03-01     0.8              34.4
## 4  2012 Apr        0.2 2012-04-01     0.3              34.5
## 5  2012 May        0.1 2012-05-01    -0.1              34.4
## 6  2012 Jun        0.1 2012-06-01    -0.1              34.4</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-sources.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="missing-values.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/huyuwei0409/preparedfooddelivery/edit/main/03-cleaning.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/huyuwei0409/preparedfooddelivery/blob/main/03-cleaning.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
